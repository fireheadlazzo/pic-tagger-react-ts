{
    "steps": [
        {
            "name": "node:13",
            "entrypoint": "npm",
            "args": ["install"],
            "dir": "server"
        },
        {
            "name": "node:13",
            "entrypoint": "npm",
            "args": ["run", "build"],
            "dir": "server"
        },
        {
            "name": "gcr.io/cloud-builders/docker",
            "args": [
                "build",
                "-t", "gcr.io/$PROJECT_ID/server:latest",
                "--cache-from", "gcr.io/$PROJECT_ID/server:latest",
                "."
            ],
            "dir": "server"
        },
        {
            "name": "gcr.io/cloud-builders/gcloud",
            "args": [
                "run", "deploy", "$PROJECT_ID-node",
                "--image", "gcr.io/$PROJECT_ID/server:latest",
                "--region", "us-central1",
                "--platform", "managed",
                "--allow-unauthenticated"
            ],
            "dir": "server"
        }
    ],
    "timeout": "1000s",
    "options": {},
    "images": ["gcr.io/$PROJECT_ID/server:latest"]
}